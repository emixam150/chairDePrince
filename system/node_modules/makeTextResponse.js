var zlib = require('zlib');

exports.send = function(content,headers,res){
    if(headers.acceptEncoding.indexOf('deflate') !== -1 ){
	zlib.deflate(content,function(err, buffer) {
	    if(!err){
		res.writeHead(200,{"Content-Encoding": "deflate",
				   "Content-Length": buffer.length });
		res.end(buffer);
	    }else{
		res.end(content);
	    }
	});
    }else if(headers.acceptEncoding.indexOf('gzip') !== -1 ){
	zlib.gzip(content,function(err, buffer) {
	    if(!err){
		res.writeHead(200,{"Content-Encoding": "deflate",
				   "Content-Length": buffer.length });
		res.end(buffer);
	    }else{
		res.end(content);
	    }
	});
    }else {
	res.writeHead(200,{"Content-Length": content.length });
	res.end(content);
    }
}
