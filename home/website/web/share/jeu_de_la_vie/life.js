window.onload=function(){function e(){this.data=[];this.nombre=0;this.generation=0;this.empty=function(){this.data=[];this.nombre=0;this.generation=0};this.setReduced=function(e){while(typeof e[0]!=="undefined"){var t=parseInt(e.shift());var n=e.shift();while(typeof n[0]!=="undefined"){var r=parseInt(n.shift());this.addORremove(t,r)}}};this.getReduced=function(e,t){var n=[],r=0;while(typeof this.data[r]!=="undefined"){var i=this.data[r][0];n.push(i-e);var s=[this.data[r][1]-t];r++;while(typeof this.data[r]!=="undefined"&&this.data[r][0]==i){s.push(this.data[r][1]-t);r++}n.push(s)}return n};this.addORremove=function(e,t){e=parseInt(e);t=parseInt(t);var n=0,r=this.data.length;while(n<r&&this.data[n][0]<=e&&(this.data[n][0]!=e||this.data[n][1]<t)){n++}if(n<r){if(this.data[n][0]==e&&this.data[n][1]==t){this.data.splice(n,1);this.nombre--}else{this.data.splice(n,0,[e,t]);this.nombre++}}else{this.data.push([e,t]);this.nombre++}return this};this.next=function(){while(this.data[0]&&!("2"in this.data[0])){var e=this.data.shift(),t=e[0],n=e[1];this.data.push([t,n,9]);this.data.push([t-1,n-1,1]);this.data.push([t-1,n,1]);this.data.push([t-1,n+1,1]);this.data.push([t,n-1,1]);this.data.push([t,n+1,1]);this.data.push([t+1,n-1,1]);this.data.push([t+1,n,1]);this.data.push([t+1,n+1,1])}this.data.sort(function(e,t){if(e[0]!=t[0]){return e[0]-t[0]}else{return e[1]-t[1]}});while(this.data[0]&&"2"in this.data[0]){var e=this.data.shift(),t=e[0],n=e[1],r=e[2];while(this.data[0]&&t==this.data[0][0]&&n==this.data[0][1]){var i=this.data.shift();r+=i[2]}if(r==3||r==11||r==12){this.data.push([t,n])}}this.nombre=this.data.length;this.generation++}}function t(e,t){this.canvas=e;this.context=this.canvas.getContext("2d");this.rayon=t;this.drag=false;this.wasdrag=false;this.mode=false;this.origine=[0,0];this.zoom=function(e,t,n){if(this.rayon<10&&this.rayon>1||this.rayon>=10&&e<0||this.rayon<=1&&e>0){this.origine[0]=(this.rayon+e/2)/this.rayon*(this.origine[0]+t)-t;this.origine[1]=(this.rayon+e/2)/this.rayon*(this.origine[1]+n)-n;if(e>0){this.rayon+=.5}else{this.rayon-=.5}}};this.getWidth=function(){return this.canvas.width};this.setWidth=function(e){this.canvas.width=e};this.getHeight=function(){return this.canvas.height};this.setHeight=function(e){this.canvas.height=e};this.draw=function(e){this.context.clearRect(0,0,this.getWidth(),this.getHeight());for(i=0;i<e.data.length;i++){if(2*this.rayon*(e.data[i][0]+1)>this.origine[0]&&2*this.rayon*e.data[i][0]<this.origine[0]+this.getWidth()&&2*this.rayon*(e.data[i][1]+1)>this.origine[1]&&2*this.rayon*e.data[i][1]<this.origine[1]+this.getHeight()){this.context.beginPath();this.context.arc(this.rayon*(2*e.data[i][0]+1)-this.origine[0],this.rayon*(2*e.data[i][1]+1)-this.origine[1],this.rayon,0,2*Math.PI);this.context.fillStyle="#E1170D";this.context.fill();this.context.closePath()}}if(!this.mode&&this.rayon>3){var t=-(this.origine[0]%(2*this.rayon)),n=-(this.origine[1]%(2*this.rayon));while(t<this.getWidth()){this.context.beginPath();this.context.moveTo(t,0);this.context.lineTo(t,this.getHeight());this.context.strokeStyle="#A2967D";this.context.stroke();this.context.closePath();t+=2*this.rayon}while(n<this.getHeight()){this.context.beginPath();this.context.moveTo(0,n);this.context.lineTo(this.getWidth(),n);this.context.strokeStyle="#A2967D";this.context.stroke();this.context.closePath();n+=2*this.rayon}}}}function n(e,t){this.vitesse=e;this.interval=undefined;this.run=function(){this.interval=setInterval(f,1e3/this.vitesse)};this.pause=function(){clearInterval(this.interval)};this.stop=function(){clearInterval(this.interval)}}function f(){r.next();s.draw(r);u.innerHTML=r.nombre;o.innerHTML=r.generation}function w(e){if(!s.mode&&!s.wasdrag){var t=Math.floor((e.clientX-b.getBoundingClientRect().left+s.origine[0])/(2*s.rayon)),n=Math.floor((e.clientY-b.getBoundingClientRect().top+s.origine[1])/(2*s.rayon));r.addORremove(t,n);s.draw(r);u.innerHTML=r.nombre}s.wasdrag=s.wasdrag?false:false}function E(e){var t=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));var n=e.clientX-b.getBoundingClientRect().left;var i=e.clientY-b.getBoundingClientRect().top;s.zoom(t,n,i);s.draw(r)}function x(e){var t=e.split("|"),n=1;while(typeof t[n]!=="undefined"){t[n]=t[n].split(",");n+=2}return t}function D(){var e=document.getElementById("sec");if(window.innerWidth<1e3){k.appendChild(e)}else{document.getElementById("variable").appendChild(e)}}function P(){C.className=C.className=="hidden"?"":"hidden"}function H(){L.className="hidden";k.className="";A.className="button";O.className="button dead"}function B(){L.className="";k.className="hidden";A.className="button dead";O.className="button"}function I(e,t,n,i,o){r.empty();for(var u=0;u<n;u++){for(var a=0;a<i;a++){if(Math.random()<o){r.addORremove(e+u,t+a)}}}s.draw(r)}function U(){var e=q.value.split("\n");r.empty();for(var t in e){if(e[t][0]!="#"){for(var n in e[t]){if(e[t][n]!="."){r.addORremove(n,t)}}}}s.origine=[-10*s.rayon,-10*s.rayon];s.draw(r)}var r=new e;var s=new t(document.getElementById("mon_canvas"),8);s.setWidth(window.innerWidth);s.setHeight(window.innerHeight-40);s.draw(r);var o=document.getElementById("generation");var u=document.getElementById("nombre");var a=4;var l=new n(a,f);var c=document.getElementById("play_input");var h=document.getElementById("stop_input");var p=document.getElementById("vitesse_input");var d=document.getElementById("exemple_input");var v=document.getElementById("exemple_select");var m=document.getElementById("plateau_input");var g=document.getElementById("obtenir_input");var y=document.getElementById("afficher_input");var b=document.getElementById("mon_canvas");c.addEventListener("click",function(){if(!s.mode){h.disabled=false;p.disabled=true;c.childNodes[1].innerHTML="â–®â–®";s.mode=true;l.run()}else{h.disabled=false;p.disabled=false;c.childNodes[1].innerHTML="â–¶";s.mode=false;l.pause();s.draw(r)}},true);h.addEventListener("click",function(){h.disabled=true;c.disabled=false;p.disabled=false;s.mode=false;l.stop();r.empty();s.draw(r)},true);p.addEventListener("change",function(){l.vitesse=p.value},false);window.addEventListener("resize",function(){s.setWidth(document.getElementById("canvas").offsetWidth);s.setHeight(document.getElementById("canvas").offsetHeight);s.draw(r)},false);b.addEventListener("click",w,false);b.addEventListener("mousewheel",E,false);b.addEventListener("DOMMouseScroll",E,false);var S;b.addEventListener("mouseout",function(){s.drag=false},false);b.addEventListener("mousedown",function(){S=setTimeout(function(){s.drag=true},100)},false);b.addEventListener("mouseup",function(){clearTimeout(S);s.drag=false;s.draw(r)},false);b.addEventListener("mousemove",function(e){if(s.drag){if(s.wasdrag){s.origine[0]-=e.clientX-s.drag[0];s.origine[1]-=e.clientY-s.drag[1];s.wasdrag++;if(!(s.wasdrag%10)){s.draw(r)}}else{s.wasdrag=1}s.drag=[e.clientX,e.clientY]}},true);g.addEventListener("click",function(){var e=Math.floor(s.origine[0]/(2*s.rayon)),t=Math.floor(s.origine[1]/(2*s.rayon));m.value=r.getReduced(e,t).join("|")},false);y.addEventListener("click",function(){var e=x(m.value);r.empty();r.setReduced(e);s.origine=[0,0];s.draw(r);u.innerHTML=r.nombre},false);var T={planeur:{value:"13|17|14|15,17|15|16,17",name:"planeur"},octogone:{value:"31|19,22|32|18,20,21,23|33|19,22|34|19,22|35|18,20,21,23|36|19,22",name:"octogone"},horloge:{value:"9|13,14|10|13,14|12|13,14,15,16|13|12,17,19,20|14|12,14,15,17,19,20|15|9,10,12,13,17|16|9,10,12,17|17|13,14,15,16|19|15,16|20|15,16",name:"horloge"},pentadecathlon:{value:"8|14|9|14|10|13,15|11|14|12|14|13|14|14|14|15|13,15|16|14|17|14",name:"pentadecathlon"},canon:{value:"11|9,10|12|9,10|21|9,10,11|22|8,12|23|7,13|24|7,13|25|10|26|8,12|27|9,10,11|28|10|31|7,8,9|32|7,8,9|33|6,10|35|5,6,10,11|45|7,8|46|7,8",name:"canon"},ligne:{value:"0|9|1|9|2|9|3|9|4|9|5|9|6|9|7|9|8|9|9|9|10|9|11|9|12|9|13|9|14|9|15|9|16|9|17|9|18|9|19|9|20|9|21|9|22|9|23|9|24|9|25|9|26|9|27|9|28|9|29|9|30|9|31|9|32|9|33|9|34|9|35|9|36|9|37|9|38|9|39|9|40|9|41|9|42|9|43|9|44|9|45|9|46|9|47|9|48|9|49|9|50|9|51|9|52|9|53|9|54|9|55|9|56|9|57|9|58|9|59|9|60|9|61|9|62|9|63|9|64|9|65|9|66|9|67|9|68|9|69|9|70|9|71|9|72|9|73|9|74|9|75|9|76|9|77|9|78|9|79|9|80|9|81|9|82|9|83|9|84|9|85|9|86|9|87|9|88|9|89|9|90|9|91|9|92|9|93|9|94|9|95|9|96|9|97|9|98|9|99|9|100|9|101|9|102|9|103|9|104|9|105|9|106|9|107|9|108|9|109|9|110|9|111|9|112|9|113|9|114|9|115|9|116|9|117|9|118|9|119|9|120|9|121|9|122|9|123|9|124|9|125|9|126|9|127|9|128|9|129|9|130|9|131|9|132|9|133|9|134|9|135|9|136|9|137|9|138|9|139|9|140|9|141|9|142|9|143|9|144|9|145|9|146|9|147|9|148|9|149|9|150|9|151|9|152|9|153|9|154|9|155|9|156|9|157|9|158|9|159|9|160|9|161|9|162|9|163|9|164|9|165|9|166|9|167|9|168|9|169|9|170|9|171|9|172|9|173|9|174|9|175|9|176|9|177|9|178|9|179|9|180|9|181|9|182|9|183|9|184|9|185|9|186|9|187|9|188|9|189|9|190|9|191|9|192|9|193|9|194|9|195|9|196|9|197|9|198|9|199|9|200|9|201|9|202|9|203|9|204|9|205|9|206|9|207|9|208|9|209|9|210|9|211|9|212|9|213|9|214|9|215|9|216|9|217|9|218|9|219|9",name:"ligne"},puffeur:{value:"3|3,7,8,20,21,25|4|4,7,8,20,21,24|5|4,7,21,24|6|4,24|7|4,9,10,12,16,18,19,24|8|1,4,10,11,12,16,17,18,24,27|9|2,3,4,11,17,24,25,26",name:"puffeur"},emeline:{value:"17|8,9,13,17,18|18|8,9,12,14,17,18|19|10,13,16|20|13|21|9,13,17|22|8,10,11,12,14,15,16,18|23|9,13,17|24|13|25|10,13,16|26|8,9,12,14,17,18|27|8,9,13,17,18",name:"emeline"},pulsar:{value:"11|11|12|10,11,12|13|10,12|14|10,11,12|15|11",name:"pulsar"},coverleaf:{value:"17|17,19|18|15,16,17,19,20,21|19|14,18,22|20|14,16,20,22|21|15,16,18,20,21|23|15,16,18,20,21|24|14,16,20,22|25|14,18,22|26|15,16,17,19,20,21|27|17,19",name:"coverleaf"},tumbler:{value:"10|10,11,12|11|10,14,15|12|11,12,13,14,15|14|11,12,13,14,15|15|10,14,15|16|10,11,12",name:"tumbler"},queen_bee_shuttle:{value:"12|14,15|13|14,15|18|13,14,15|19|13,14,15|20|12,16|22|11,12,16,17|32|14,15|33|14,15",name:"queen bee shuttle"},blocker:{value:"2|4,5|3|2,5|5|2,5|6|3,6|7|4,6|8|5|10|4,5|11|4,5",name:"blocker"},matthias_spaceship:{value:"5|10,11,12,13|6|8,9,14,15|7|8,9,15|8|10,11,13,15|9|15|10|11,15|11|11,16|12|13,14,15,19|13|13,14,19|14|19,20|15|21|16|21,22,23|19|24|20|23,25,26,27,28,29|21|22,23,29|22|22,23,27,30|23|30|24|24,25,27,30|25|27,30|26|28,29|27|28,29",name:"Matthia's spaceship"},oscillatortrenteun:{value:"12|11,12,20,21|13|11,12,20,21|18|11,21|19|10,12,20,22|20|10,13,19,22|21|10,11,12,20,21,22|22|11,21|25|11,21|26|10,11,12,20,21,22|27|10,13,19,22|28|10,12,20,22|29|11,21|34|11,12,20,21|35|11,12,20,21",name:"31-oscillateur"},croix_gammee:{value:"4|5,6,7|5|7,10|6|7,10|7|4,5,6,7,8,9,10|8|4,7|9|4,7|10|7,8,9",name:"croix gammÃ©e"},carre_constructeur:{value:"10|14|12|13,14|14|10,11,12|16|9,10,11|17|10",name:"constructeur minimal de carrÃ©s"},two_way_constructor:{value:"4|9|5|9|6|9|7|9|8|9|9|9|10|9|11|9|13|9|14|9|15|9|16|9|17|9|21|9|22|9|23|9|30|9|31|9|32|9|33|9|34|9|35|9|36|9|38|9|39|9|40|9|41|9|42|9",name:"constructeur de carrÃ©s dans 2 directions"},acorn:{value:"8|12|9|10,12|11|11|12|12|13|12|14|12",name:"acorn"},diehard:{value:"8|8|9|8,9|13|9|14|7,9|15|9",name:"diehard"}};for(var N in T){v.innerHTML+='<option value="'+N+'">'+T[N].name+"</option>"}d.addEventListener("click",function(){var e=x(T[v.value].value);r.empty();r.setReduced(e);s.origine=[0,0];s.draw(r);u.innerHTML=r.nombre},false);var C=document.getElementById("panneau"),k=document.getElementById("place_option"),L=document.getElementById("place_docs"),A=document.getElementById("input_docs"),O=document.getElementById("input_opts"),M=document.getElementById("input_close"),_=document.getElementById("option");D();window.addEventListener("resize",D,false);M.addEventListener("click",P,false);_.addEventListener("click",P,false);O.addEventListener("click",H,false);A.addEventListener("click",B,false);var j=document.getElementById("input_coef"),F=document.getElementById("input_random");F.addEventListener("click",function(e){function l(e){if(u%5==0){u++;s.draw(r);var t=e.clientX-b.getBoundingClientRect().left;var n=e.clientY-b.getBoundingClientRect().top;s.context.beginPath();s.context.setLineDash([10]);s.context.strokeStyle="#E1170D";s.context.rect(Math.min(t,i),Math.min(o,n),Math.abs(t-i),Math.abs(n-o));s.context.stroke();s.context.closePath();s.context.setLineDash([])}else{u++}}function c(e){if(a==0){t=Math.floor((e.clientX-b.getBoundingClientRect().left+s.origine[0])/(2*s.rayon));n=Math.floor((e.clientY-b.getBoundingClientRect().top+s.origine[1])/(2*s.rayon));i=e.clientX-b.getBoundingClientRect().left;o=e.clientY-b.getBoundingClientRect().top;a++;l(e);b.addEventListener("mousemove",l,false)}else{b.removeEventListener("mousemove",l,false);var r=Math.floor((e.clientX-b.getBoundingClientRect().left+s.origine[0])/(2*s.rayon)),u=Math.floor((e.clientY-b.getBoundingClientRect().top+s.origine[1])/(2*s.rayon));var h=Math.abs(t-r),p=Math.abs(n-u);t=Math.min(t,r);n=Math.min(n,u);I(t,n,h+1,p+1,f);b.removeEventListener("click",c,false);b.addEventListener("click",w,false)}}var t,n,i,o,u=0,a=0,f=j.value;b.removeEventListener("click",w,false);b.addEventListener("click",c,false)},false);var q=document.getElementById("input_filelife");var R=document.getElementById("input_afflife");R.addEventListener("click",U,false)}
